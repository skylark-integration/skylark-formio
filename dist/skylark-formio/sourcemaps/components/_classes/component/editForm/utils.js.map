{"version":3,"sources":["components/_classes/component/editForm/utils.js"],"names":["define","_","Evaluator","EditFormUtils","sortAndFilterComponents","components","filter","sortBy","item","ignore","unifyComponents","objValue","srcValue","key","skipMerge","each","value","prop","hasOwnProperty","unionWith","isEqual","logicVariablesTable","additional","type","tag","content","[object Object]","title","property","propertyJSON","weight","exampleHTML","exampleJSON","additionalParams","theme","collapsible","collapsed","this","style","margin-bottom","customConditional","noeval","rows","editor","hideLabel","input","as"],"mappings":";;;;;;;AAAAA,QACI,iBACA,+BACD,SAAUC,EAAGC,GACZ,aACA,MAAMC,GACFC,wBAAwBC,GACbJ,EAAEK,OAAOL,EAAEM,OAAOF,EAAY,UAAWG,IAASA,EAAKC,QAElEC,gBAAe,CAACC,EAAUC,IAClBD,EAASE,KAAOD,EAASC,KACrBF,EAASG,YAAaF,EAASE,YAG/BH,EAASE,MAAQD,EAASC,MAC1BZ,EAAEc,KAAKJ,EAAU,CAACK,EAAOC,KAChBL,EAASM,eAAeD,KACzBL,EAASK,GAAQD,KAGzBf,EAAEc,KAAKH,EAAU,CAACI,EAAOC,KAChBN,EAASO,eAAeD,KACzBN,EAASM,GAAQD,KAGrBL,EAASN,aACTO,EAASP,WAAaF,EAAcC,wBAAwBH,EAAEkB,UAAUR,EAASN,WAAYO,EAASP,WAAYF,EAAcO,oBAE7H,IAKRT,EAAEmB,QAAQT,EAAUC,GAE/BS,oBAAoBC,KAGZC,KAAM,cACNC,IAAK,MACLC,QAAS,kIAJbH,EAAaA,GAAc,IAIuI,i5BAGtKI,gBAAgBC,EAAOC,EAAUC,EAAcC,EAAQC,EAAaC,EAAaC,GAC7E,OACIV,KAAM,QACNI,MAAOA,EACPO,MAAO,UACPC,aAAa,EACbC,WAAW,EACXvB,OAASe,SACTE,OAAQA,EACRzB,YACIgC,KAAKhB,oBAAoBY,IAErBV,KAAM,QACNI,MAAO,aACPQ,aAAa,EACbC,WAAW,EACXE,OAASC,gBAAiB,QAC1B1B,OAASe,OACTY,kBAAiB,KACLtC,EAAUuC,OAEtBpC,aAEQkB,KAAM,WACNV,IAAKe,EACLc,KAAM,EACNC,OAAQ,MACRC,WAAW,EACXC,OAAO,IAGPtB,KAAM,cACNC,IAAK,MACLC,+CAAiDM,QAKzDR,KAAM,QACNI,MAAO,YACPQ,aAAa,EACbC,WAAW,EACXvB,OAASe,SACTvB,aAEQkB,KAAM,cACNC,IAAK,MACLC,QAAS,kRAAyRO,IAGlST,KAAM,WACNV,IAAKgB,EACLa,KAAM,EACNC,OAAQ,MACRC,WAAW,EACXE,GAAI,OACJD,OAAO,SAQnC,OAAO1C","file":"../../../../../components/_classes/component/editForm/utils.js","sourcesContent":["define([\n    'skylark-lodash',\n    '../../../../utils/Evaluator'\n], function (_, Evaluator) {\n    'use strict';\n    const EditFormUtils = {\n        sortAndFilterComponents(components) {\n            return _.filter(_.sortBy(components, 'weight'), item => !item.ignore);\n        },\n        unifyComponents(objValue, srcValue) {\n            if (objValue.key && srcValue.key) {\n                if (objValue.skipMerge || srcValue.skipMerge) {\n                    return false;\n                }\n                if (objValue.key === srcValue.key) {\n                    _.each(objValue, (value, prop) => {\n                        if (!srcValue.hasOwnProperty(prop)) {\n                            srcValue[prop] = value;\n                        }\n                    });\n                    _.each(srcValue, (value, prop) => {\n                        if (!objValue.hasOwnProperty(prop)) {\n                            objValue[prop] = value;\n                        }\n                    });\n                    if (objValue.components) {\n                        srcValue.components = EditFormUtils.sortAndFilterComponents(_.unionWith(objValue.components, srcValue.components, EditFormUtils.unifyComponents));\n                    }\n                    return true;\n                } else {\n                    return false;\n                }\n            }\n            return _.isEqual(objValue, srcValue);\n        },\n        logicVariablesTable(additional) {\n            additional = additional || '';\n            return {\n                type: 'htmlelement',\n                tag: 'div',\n                content: '<p>The following variables are available in all scripts.</p>' + '<table class=\"table table-bordered table-condensed table-striped\">' + additional + '<tr><th>form</th><td>The complete form JSON object</td></tr>' + '<tr><th>submission</th><td>The complete submission object.</td></tr>' + '<tr><th>data</th><td>The complete submission data object.</td></tr>' + '<tr><th>row</th><td>Contextual \"row\" data, used within DataGrid, EditGrid, and Container components</td></tr>' + '<tr><th>component</th><td>The current component JSON</td></tr>' + '<tr><th>instance</th><td>The current component instance.</td></tr>' + '<tr><th>value</th><td>The current value of the component.</td></tr>' + '<tr><th>moment</th><td>The moment.js library for date manipulation.</td></tr>' + '<tr><th>_</th><td>An instance of <a href=\"https://lodash.com/docs/\" target=\"_blank\">Lodash</a>.</td></tr>' + '<tr><th>utils</th><td>An instance of the <a href=\"http://formio.github.io/formio.js/docs/identifiers.html#utils\" target=\"_blank\">FormioUtils</a> object.</td></tr>' + '<tr><th>util</th><td>An alias for \"utils\".</td></tr>' + '</table><br/>'\n            };\n        },\n        javaScriptValue(title, property, propertyJSON, weight, exampleHTML, exampleJSON, additionalParams) {\n            return {\n                type: 'panel',\n                title: title,\n                theme: 'default',\n                collapsible: true,\n                collapsed: true,\n                key: `${ property }Panel`,\n                weight: weight,\n                components: [\n                    this.logicVariablesTable(additionalParams),\n                    {\n                        type: 'panel',\n                        title: 'JavaScript',\n                        collapsible: true,\n                        collapsed: false,\n                        style: { 'margin-bottom': '10px' },\n                        key: `${ property }-js`,\n                        customConditional() {\n                            return !Evaluator.noeval;\n                        },\n                        components: [\n                            {\n                                type: 'textarea',\n                                key: property,\n                                rows: 5,\n                                editor: 'ace',\n                                hideLabel: true,\n                                input: true\n                            },\n                            {\n                                type: 'htmlelement',\n                                tag: 'div',\n                                content: `<p>Enter custom javascript code.</p>${ exampleHTML }`\n                            }\n                        ]\n                    },\n                    {\n                        type: 'panel',\n                        title: 'JSONLogic',\n                        collapsible: true,\n                        collapsed: true,\n                        key: `${ property }-json`,\n                        components: [\n                            {\n                                type: 'htmlelement',\n                                tag: 'div',\n                                content: '<p>Execute custom logic using <a href=\"http://jsonlogic.com/\" target=\"_blank\">JSONLogic</a>.</p>' + '<p>Full <a href=\"https://lodash.com/docs\" target=\"_blank\">Lodash</a> support is provided using an \"_\" before each operation, such as <code>{\"_sum\": {var: \"data.a\"}}</code></p>' + exampleJSON\n                            },\n                            {\n                                type: 'textarea',\n                                key: propertyJSON,\n                                rows: 5,\n                                editor: 'ace',\n                                hideLabel: true,\n                                as: 'json',\n                                input: true\n                            }\n                        ]\n                    }\n                ]\n            };\n        }\n    };\n    return EditFormUtils;\n});"]}
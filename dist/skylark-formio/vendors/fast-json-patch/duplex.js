/**
 * skylark-formio - A version of formio.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-formio/
 * @license MIT
 */
define(["./helpers","./core"],function(e,n){var t=new WeakMap,o=function(){return function(e){this.observers=new Map,this.obj=e}}(),a=function(){return function(e,n){this.callback=e,this.observer=n}}();function c(e){var o=t.get(e.object);r(o.value,e.object,e.patches,""),e.patches.length&&n.applyPatch(o.value,e.patches);var a=e.patches;return a.length>0&&(e.patches=[],e.callback&&e.callback(a)),a}function r(n,t,o,a){if(t!==n){"function"==typeof t.toJSON&&(t=t.toJSON());for(var c=e._objectKeys(t),u=e._objectKeys(n),d=!1,i=u.length-1;i>=0;i--){var s=n[p=u[i]];if(!e.hasOwnProperty(t,p)||void 0===t[p]&&void 0!==s&&!1===Array.isArray(t))o.push({op:"remove",path:a+"/"+e.escapePathComponent(p)}),d=!0;else{var v=t[p];"object"==typeof s&&null!=s&&"object"==typeof v&&null!=v?r(s,v,o,a+"/"+e.escapePathComponent(p)):s!==v&&(!0,o.push({op:"replace",path:a+"/"+e.escapePathComponent(p),value:e._deepClone(v)}))}}if(d||c.length!=u.length)for(i=0;i<c.length;i++){var p=c[i];e.hasOwnProperty(n,p)||void 0===t[p]||o.push({op:"add",path:a+"/"+e.escapePathComponent(p),value:e._deepClone(t[p])})}}}return{applyPatch:n.applyPatch,unobserve:function(e,n){n.unobserve()},observe:function(n,r){var u,d=function(e){return t.get(e)}(n);if(d){var i=function(e,n){return e.observers.get(n)}(d,r);u=i&&i.observer}else d=new o(n),t.set(n,d);if(u)return u;if(u={},d.value=e._deepClone(n),r){u.callback=r,u.next=null;var s=function(){c(u)},v=function(){clearTimeout(u.next),u.next=setTimeout(s)};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mouseup",v),window.addEventListener("keyup",v),window.addEventListener("mousedown",v),window.addEventListener("keydown",v),window.addEventListener("change",v)):(document.documentElement.attachEvent("onmouseup",v),document.documentElement.attachEvent("onkeyup",v),document.documentElement.attachEvent("onmousedown",v),document.documentElement.attachEvent("onkeydown",v),document.documentElement.attachEvent("onchange",v)))}return u.patches=[],u.object=n,u.unobserve=function(){c(u),clearTimeout(u.next),function(e,n){e.observers.delete(n.callback)}(d,u),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mouseup",v),window.removeEventListener("keyup",v),window.removeEventListener("mousedown",v),window.removeEventListener("keydown",v)):(document.documentElement.detachEvent("onmouseup",v),document.documentElement.detachEvent("onkeyup",v),document.documentElement.detachEvent("onmousedown",v),document.documentElement.detachEvent("onkeydown",v)))},d.observers.set(r,new a(r,u)),u},generate:c,compare:function(e,n){var t=[];return r(e,n,t,""),t}}});
//# sourceMappingURL=../../sourcemaps/vendors/fast-json-patch/duplex.js.map

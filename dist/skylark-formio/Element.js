/**
 * skylark-formio - A version of formio.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-formio/
 * @license MIT
 */
define(["skylark-langx","./EventEmitter","./Formio","./utils/utils","skylark-i18next","skylark-moment","./vendors/vanilla-text-mask/maskInput"],function(t,e,n,s,i,r,o){"use strict";return class{constructor(t){this.options=Object.assign({language:"en",highlightErrors:!0,componentErrorClass:"formio-error-wrapper",componentWarningClass:"formio-warning-wrapper",row:"",namespace:"formio"},t||{}),this.id=s.getRandomComponentId(),this.eventHandlers=[],this.i18next=this.options.i18next||i,this.events=t&&t.events?t.events:new e({wildcard:!1,maxListeners:0}),this.defaultMask=null}on(t,e,n,s=!1){if(!this.events)return;const i=`${this.options.namespace}.${t}`;return e.id=this.id,e.internal=n,this.events[s?"once":"on"](i,e)}once(t,e,n){return this.on(t,e,n,!0)}onAny(t){if(this.events)return this.events.onAny(t)}off(e){if(!this.events)return;const n=`${this.options.namespace}.${e}`;t.forEach(this.events.listeners(n),t=>{t&&t.id===this.id&&this.events.off(n,t)})}emit(t,...e){this.events&&this.events.emit(`${this.options.namespace}.${t}`,...e)}addEventListener(t,e,n,s){if(t)return s||this.eventHandlers.push({id:this.id,obj:t,type:e,func:n}),"addEventListener"in t?t.addEventListener(e,n,!1):"attachEvent"in t&&t.attachEvent(`on${e}`,n),this}removeEventListener(e,n,s=null){const i=[];return this.eventHandlers.forEach((t,r)=>{t.id!==this.id||!e.removeEventListener||t.type!==n||s&&t.func!==s||(e.removeEventListener(n,t.func),i.push(r))}),i.length&&t.pullAt(this.eventHandlers,i),this}removeEventListeners(){this.eventHandlers.forEach(t=>{this.id===t.id&&t.type&&t.obj&&t.obj.removeEventListener&&t.obj.removeEventListener(t.type,t.func)}),this.eventHandlers=[]}removeAllEvents(e){t.forEach(this.events._events,(n,s)=>{t.forEach(n,t=>{t&&this.id===t.id&&(e||t.internal)&&this.events.off(s,t)})})}destroy(){this.removeEventListeners(),this.removeAllEvents()}appendTo(t,e){return e.appendChild(t),this}prependTo(t,e){if(e)if(e.firstChild)try{e.insertBefore(t,e.firstChild)}catch(n){console.warn(n),e.appendChild(t)}else e.appendChild(t);return this}removeChildFrom(t,e){if(e&&e.contains(t))try{e.removeChild(t)}catch(t){console.warn(t)}return this}ce(t,e,n=null){const s=document.createElement(t);return e&&this.attr(s,e),this.appendChild(s,n),s}appendChild(t,e){return Array.isArray(e)?e.forEach(e=>this.appendChild(t,e)):e instanceof HTMLElement||e instanceof Text?t.appendChild(e):e&&t.appendChild(this.text(e.toString())),this}maskPlaceholder(t){return t.map(t=>t instanceof RegExp?"_":t).join("")}setInputMask(t,e,n){if(t&&e){const i=s.getInputMask(e);this.defaultMask=i;try{t.mask&&t.mask.destroy(),t.mask=o({inputElement:t,mask:i})}catch(t){console.warn(t)}i.numeric&&t.setAttribute("pattern","\\d*"),n&&t.setAttribute("placeholder",this.maskPlaceholder(i))}}t(t,e){return(e=e||{}).nsSeparator="::",e.keySeparator=".|.",e.pluralSeparator="._.",e.contextSeparator="._.",this.i18next.t(t,e)||t}text(t){return document.createTextNode(this.t(t))}attr(e,n){e&&t.forEach(n,(t,n)=>{void 0!==t&&(0===n.indexOf("on")?this.addEventListener(e,n.substr(2).toLowerCase(),t):e.setAttribute(n,t))})}hasClass(t,e){return!!t&&(e=` ${e} `,` ${t.className} `.replace(/[\n\t\r]/g," ").indexOf(e)>-1)}addClass(t,e){if(!t)return this;const n=t.getAttribute("class");return n.includes(e)||t.setAttribute("class",`${n} ${e}`),this}removeClass(t,e){if(!t||!e)return this;let n=t.getAttribute("class");return n&&(n=n.replace(new RegExp(` ${e}`,"g"),""),t.setAttribute("class",n)),this}empty(t){if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}evalContext(e){return Object.assign({_:t,utils:s,util:s,user:n.getUser(),moment:r,instance:this,self:this,token:n.getToken({decode:!0}),config:this.root&&this.root.form&&this.root.form.config?this.root.form.config:{}},e,t.get(this.root,"options.evalContext",{}))}interpolate(t,e){return s.interpolate(t,this.evalContext(e))}evaluate(t,e,n,i){return s.evaluate(t,this.evalContext(e),n,i)}hook(){const t=arguments[0];if(this.options&&this.options.hooks&&this.options.hooks[t])return this.options.hooks[t].apply(this,Array.prototype.slice.call(arguments,1));{const t="function"==typeof arguments[arguments.length-1]?arguments[arguments.length-1]:null;return t?t(null,arguments[1]):arguments[1]}}}});
//# sourceMappingURL=sourcemaps/Element.js.map
